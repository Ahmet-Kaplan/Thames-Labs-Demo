machine:
  java:
    version: oraclejdk8
  node:
    version: 5.2.0
  environment:
    CUCUMBER_JSON_OUTPUT: $CIRCLE_TEST_REPORTS/cucumber/tests.cucumber
  post:
    - env
    - mkdir -p $CIRCLE_TEST_REPORTS/cucumber
general:
  artifacts:
    - $CIRCLE_TEST_REPORTS
    - target
dependencies:
  cache_directories:
    - "node_modules"
    - "~/.npm"
    - "~/_opt"
    - ~/.meteor
  override:
    - curl https://install.meteor.com/ | sh
    - npm install
    - npm install glob
test:
  override:
    - mkdir -p $CIRCLE_TEST_REPORTS/cucumber
    - bundle exec cucumber --format json --out $CIRCLE_TEST_REPORTS/cucumber/tests.cucumber
    - npm run lint
