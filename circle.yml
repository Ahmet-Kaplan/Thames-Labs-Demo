machine:
  environment:
    CUCUMBER_TAIL: 1
    SELENIUM_BROWSER: chrome
    VELOCITY_CI: 1

dependencies:
  pre:
    - env

  cache_directories:
    - "~/.meteor"
    - "~/.npm"

  override:
    - npm install -g eslint
    - cd tests/cucumber && npm install

    # -- CACHE METEOR --
    # Restore the meteor symlink
    - if [ -d ~/.meteor ]; then sudo ln -s ~/.meteor/meteor /usr/local/bin/meteor; fi
    # Install Meteor if the cache didn't restore it
    - if [ ! -e ~/.meteor/meteor ]; then curl https://install.meteor.com | sh; fi

    # Build version of app to download packages so they can be cached
    - meteor --test
test:
  override:
    - eslint .
