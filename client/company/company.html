<template name="companies">

  <ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li class="active">Companies</li>
  </ol>

  <div class="row">

    <div class="col-md-3">
      <div class="sidebar">
        <h1>Actions</h1>
        {{> esInput index="companies" placeholder="search..." allDocsOnEmpty=true reactive=false class="form-control"}}
        <div class="btn-group-vertical">
          {{#afModal class="btn btn-primary" collection="Companies" operation="insert" formId="insertCompanyForm"}}
            Add new company
          {{/afModal}}
        </div>
      </div>
    </div>

    <div class="col-md-9">

      <h1><i class="fa fa-building"></i> Companies</h1>

      <div class="list-group">
        {{#ifEsIsSearching index="companies"}}
          {{> spinner}}
        {{else}}
          {{#esEach index="companies"}}
            {{>companySummary}}
          {{/esEach}}
          {{> esLoadMoreButton index="companies" class="btn btn-default"}}
        {{/ifEsIsSearching}}
      </div>

    </div>
  </div>

  {{> autoformModals}}

</template>

<template name="companySummary">
  <a class="list-group-item" href="{{pathFor route='company'}}">
    <h4 class="list-group-item-heading">{{name}}</h4>
    <p class="list-group-item-text"><i class="fa fa-fw fa-map-marker"></i> {{city}}, {{country}}</p>
  </a>
</template>

<template name="companyDetail">

  <ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/companies">Companies</a></li>
    <li class="active">{{name}}</li>
  </ol>

  <div class="row">
    <div class="col-md-3">
      <div class="sidebar">
        <h1>Actions</h1>
        <div class="btn-group-vertical">
          {{#afModal class="btn btn-primary" collection="Companies" doc=_id operation="update" formId="updateCompanyForm"}}
            Edit company details
          {{/afModal}}

          {{#afModal class="btn btn-danger" collection="Companies" doc=_id operation="remove" formId="removeCompanyForm" onSuccess="onCompanyRemove"}}
            Delete company
          {{/afModal}}
        </div>
        <div class="btn-group">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Use Word template <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#" id="template-upload-link">Select word template</a></li>
            <li class="divider"></li>
            <li><a href="#" id="template-help">How does this work?</a></li>
          </ul>
        </div>
        <input type="file" id="template-upload" style="display:none;">
      </div>
    </div>

    <div class="col-md-6">
      <h1>{{name}}</h1>
      <div class="panel panel-default">
        <div class="panel-heading">Company details</div>
        <ul class="list-group">
          {{#if website}}
            <a href="{{website}}" target="_blank" class="list-group-item">
              <i class="fa fa-fw fa-laptop"></i> {{website}}
              <i class="fa fa-fw fa-chevron-right pull-right"></i>
            </a>
          {{/if}}
          {{#if phone}}
            <a href="{{phoneHref phone}}" class="list-group-item">
              <i class="fa fa-fw fa-phone"></i> {{phone}}
              <i class="fa fa-fw fa-chevron-right pull-right"></i>
            </a>
          {{/if}}
        </ul>
      </div>
    </div>

    <div class="col-md-3">
      <h1>Address</h1>
      <div class="thumbnail">
        <img src="https://maps.googleapis.com/maps/api/staticmap?center={{addressString}}&zoom=15&size=600x600&markers={{addressString}}">
        <div class="caption">
          <address>
            <strong>{{name}}</strong><br>
            {{address}}<br>
            {{city}}<br>
            {{county}}<br>
            {{postcode}}<br>
            {{country}}
          </address>
        </div>
      </div>
    </div>

  </div>

  {{> autoformModals}}

</template>

<template name="wordHelpModal">
  <div class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4>Help on templates</h4>
        </div>
        <div class="modal-body">
          <p>You can upload a word document template and we'll replace tags defined like {name}</p>
          <p>Tags available on this page:</p>
          <ul>
            <li>{name} - Company name</li>
            <li>{address} - 1st line of company address</li>
            <li>{city} - Company's city / town</li>
            <li>{county} - Company's county / state</li>
            <li>{postcode} - Company's postcode / zip</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</template>
