<template name="companyDetail">
  {{#with companyData}} {{setPageTitle "Company - " name }}
  <div class="row">
    <div class="col-md-2 hidden-sm hidden-xs">
      <div class="sidebar">

        <h1>Actions</h1>

        <ul class="nav nav-stacked">
          <li><a href="#company-details">Company details</a></li>
          <li><a href="#contacts">Contacts</a></li>
          <li><a href="#projects">Current Projects</a></li>
          <li><a href="#activity-timeline">Activity timeline</a></li>
        </ul>

        <div class="btn-group">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Use Word template
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#" id="template-upload-link">Select word template</a></li>
            <li class="divider"></li>
            <li><a href="#" id="template-help">How does this work?</a></li>
          </ul>
        </div>
        <input type="file" id="template-upload" style="display:none;">

      </div>
    </div>

    <div class="col-md-6">
      <h1 id="company-details">Company: {{name}}</h1>

      {{> tagInput}}

      <div class="panel panel-default">
        <div class="panel-heading">
          <div class="btn-group pull-right">
            {{#afModal class="btn btn-info btn-xs" collection="Companies" doc=_id operation="update" formId="updateCompanyForm" omitFields="tags, tagGroups"}} Edit company details {{/afModal}} {{#afModal class="btn btn-danger btn-xs" collection="Companies" doc=_id
            operation="remove" formId="removeCompanyForm" }} Delete company {{/afModal}}
          </div>
          Company details
        </div>
        <ul class="list-group">
          {{#if website}}
          <a href="{{website}}" target="_blank" class="list-group-item">
            <i class="fa fa-fw fa-laptop"></i> {{website}}
            <i class="fa fa-fw fa-chevron-right pull-right"></i>
          </a>
          {{/if}} {{#if phone}}
          <a href="{{phoneHref phone}}" class="list-group-item">
            <i class="fa fa-fw fa-phone"></i> {{phone}}
            <i class="fa fa-fw fa-chevron-right pull-right"></i>
          </a>
          {{/if}}
        </ul>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading" id="contacts">
          Contacts
          <a href="#" id="add-contact" class="btn btn-primary btn-xs pull-right"><i class="fa fa-plus"></i> Add contact</a>
        </div>
        <ul class="list-group">
          {{#each contacts}}
          <a href="{{pathFor route='contact' id=_id}}" class="list-group-item">
            <i class="fa fa-fw fa-user"></i> {{title}} {{forename}} {{surname}}
            <i class="fa fa-fw fa-chevron-right pull-right"></i>
          </a>
          {{else}}
          <li class="list-group-item">No contacts added</li>
          {{/each}}
        </ul>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading" id="projects">
          Projects
          <a href="#" id="add-project" class="btn btn-primary btn-xs pull-right"><i class="fa fa-plus"></i> Add project</a>
        </div>
        <ul class="list-group">
          {{#each projects}}
          <a href="{{pathFor route='project' id=_id}}" class="list-group-item">
            <i class="fa fa-fw fa-files-o"></i> {{description}}
            <i class="fa fa-fw fa-chevron-right pull-right"></i>
          </a>
          {{else}}
          <li class="list-group-item">No projects</li>
          {{/each}}
        </ul>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading" id="purchase-orders">
          Purchase Orders
          <a href="#" id="add-purchase-order" class="btn btn-primary btn-xs pull-right"><i class="fa fa-plus"></i> Add purchase order</a>
        </div>
        <ul class="list-group">
          {{#each purchaseOrders}}
          <a href="{{pathFor route='purchaseOrder' id=_id}}" class="list-group-item">
            <i class="fa fa-fw fa-shopping-cart"></i> {{description}}
            <i class="fa fa-fw fa-chevron-right pull-right"></i>
          </a>
          {{else}}
          <li class="list-group-item">No purchase orders</li>
          {{/each}}
        </ul>
      </div>

      {{#with this}} {{> taskDisplay entity_type="company" entity_id=_id}} {{/with}}

      <div>
        {{#with this}} {{> customFieldDisplay}} {{/with}}
      </div>

    </div>

    <div class="col-md-4">
      <h1>Address</h1>
      <div class="thumbnail">
        {{#if isDesktop}} {{> map data=this}} {{/if}} {{#if isPhone}}
        <img src="https://maps.googleapis.com/maps/api/staticmap?center={{addressString}}&zoom=15&size=600x600&markers={{addressString}}"> {{/if}}
        <div class="caption">
          <address>
            <strong>{{name}}</strong>
            <br /> {{address}}
            <br /> {{#if address2}}{{address2}}
            <br />{{/if}} {{city}}
            <br /> {{county}}
            <br /> {{postcode}}
            <br /> {{country}}
          </address>
        </div>
      </div>
    </div>

  </div>

  <div class="row">
    <div class="col-md-10 col-md-offset-2">
      <h1 id="activity-timeline">
        Activity Timeline
        <a href="#" class="btn btn-primary pull-right" id="add-activity"><i class="fa fa-plus"></i> Add activity</a>
      </h1>

      {{> activityTimeline activities=activities}}
    </div>
  </div>

  {{> autoformModals}} {{/with}}
</template>
