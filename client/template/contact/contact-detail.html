<template name="contactDetail">
  {{#with contactData}} {{setPageTitle "Contact - " name }}
  <div class="row">
    <div class="col-md-2 hidden-xs hidden-sm">
      <div class="sidebar">
        <h1>Actions</h1>

        <ul class="nav nav-stacked">
          <li><a href="#contact-details">Contact details</a></li>
          <li><a href="#activity-timeline">Activity timeline</a></li>
        </ul>

      </div>
    </div>

    <div class="col-md-6">
      <h4 class="entity-title">Contact</h4>
      <h1 id="contact-details" class="entity-name">{{name}}</h1>

      {{> tagInput}}

      <div class="panel panel-default">
        <div class="panel-heading">
          <div class="btn-group pull-right">
            <a href="#" id="edit-contact" class="btn btn-info btn-xs">Edit contact details</a>
            <a href="#" id="remove-contact" class="btn btn-danger btn-xs">Delete contact</a>
          </div>
          Contact details</div>
        <ul class="list-group">
          {{#if company}}
          <a href="{{pathFor route='company' id=company._id}}" class="list-group-item">
            <i class="fa fa-fw fa-building"></i> {{company.name}}
            <i class="fa fa-fw fa-chevron-right pull-right"></i>
          </a>
          {{/if}} {{#if jobtitle}}
          <li class="list-group-item">
            <i class="fa fa-fw fa-graduation-cap"></i> {{jobtitle}}
          </li>
          {{/if}} {{#if email}}
          <li class="list-group-item">
            <i class="fa fa-fw fa-envelope"></i> {{email}}
          </li>
          {{/if}} {{#if phone}}
          <li class="list-group-item">
            <i class="fa fa-fw fa-phone"></i> {{phone}}
          </li>
          {{/if}} {{#if mobile}}
          <li class="list-group-item">
            <i class="fa fa-fw fa-mobile"></i> {{mobile}}
          </li>
          {{/if}}
        </ul>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading" id="projects">
          Projects
          <a href="#" id="add-project" class="btn btn-primary btn-xs pull-right"><i class="fa fa-fw fa-plus"></i> Add project</a>
        </div>
        <ul class="list-group">
          {{#each projects}} {{> ContactProjectListItem}} {{else}}
          <li class="list-group-item">No projects</li>
          {{/each}}
        </ul>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading" id="purchase-orders">
          Purchase Orders
          <a href="#" id="add-purchase-order" class="btn btn-primary btn-xs pull-right"><i class="fa fa-fw fa-plus"></i> Add purchase order</a>
        </div>
        <ul class="list-group">
          {{#each purchaseOrders}}
          <a href="{{pathFor route='purchaseOrder' id=_id}}" class="list-group-item">
            <i class="fa fa-fw fa-shopping-cart"></i> {{description}}
            <i class="fa fa-fw fa-chevron-right pull-right"></i>
          </a>
          {{else}}
          <li class="list-group-item">No purchase orders</li>
          {{/each}}
        </ul>
      </div>

      {{#with this}} {{> taskDisplay entity_type="contact" entity_id=_id}} {{/with}}

      <div>
        {{#with this}} {{> customFieldDisplay entity_data=this entity_type='contact'}} {{/with}}
      </div>

    </div>

  <div class="col-md-4">
      <h1>Address</h1>
      <div class="thumbnail">
      {{#if companyId}}
        {{#if isDesktop}} <div id="map-wrapper">{{> map data=companyDetails}}</div> {{/if}}
        {{#if isPhone}}
          <img src="https://maps.googleapis.com/maps/api/staticmap?center={{addressString}}&zoom=15&size=600x600&markers={{addressString}}" /> {{/if}}
          <div class="caption">
            <address>
              <strong>{{name}}</strong>
              {{#with companyDetails}}
                <br /><strong>{{name}}</strong>
                <br /> {{address}}
                {{#if address2}} <br /> {{address2}} {{/if}}
                <br /> {{city}}
                {{#if county}} <br /> {{county}} {{/if}}
                <br /> {{postcode}}
                <br /> {{country}}
              {{/with}}
            </address>
          </div>
      {{else}}
        {{#if isDesktop}} <div id="map-wrapper">{{> map data=this}}</div> {{/if}}
        {{#if isPhone}}
          <img src="https://maps.googleapis.com/maps/api/staticmap?center={{addressString}}&zoom=15&size=600x600&markers={{addressString}}" /> {{/if}}
          <div class="caption">
            <address>
              <strong>{{name}}</strong>
              <br /> {{address}}
              {{#if address2}} <br /> {{address2}} {{/if}}
              <br /> {{city}}
              {{#if county}} <br /> {{county}} {{/if}}
              <br /> {{postcode}}
              <br /> {{country}}
            </address>
          </div>
      {{/if}}
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-10 col-md-offset-2">
      <h1 id="activity-timeline">
        Activity Timeline
        <a href="#" class="btn btn-primary pull-right" id="add-activity"><i class="fa fa-fw fa-plus"></i> Add activity</a>
      </h1>
      {{> activityTimeline activities=activities}}
    </div>
  </div>

  {{> autoformModals}} {{/with}}
</template>

<template name="ContactProjectListItem">
  <a href="{{pathFor route='project' id=_id}}" class="list-group-item">
    <div class="row">
      <div class="col-md-8">
        <i class="fa fa-fw fa-files-o"></i> {{description}}
      </div>
      <div class="col-md-3 userDataDisplay">
        {{#if companyProject}}<i class="fa fa-fw fa-building"></i> {{projectCompanyName}}{{/if}}
      </div>
      <div class="col-md-1">
        <i class="fa fa-fw fa-chevron-right pull-right"></i>
      </div>
    </div>
  </a>
</template>
