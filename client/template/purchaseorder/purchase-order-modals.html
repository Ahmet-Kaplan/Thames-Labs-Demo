<template name="newPurchaseOrderForm">
  <div class="modal fade" id="draggableModal">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h5> Add new purchase order</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrders" id="newPurchaseOrderForm" type="insert"}}
            {{> afQuickField name="description" id="description"}}
            {{> afQuickField name="supplierCompanyId" id="selectedSupplier" options=companiesAsOptions}}
            {{#if showSupplierContacts}}
              {{> afQuickField name="supplierContactId" id="selectedSupplierContact" options=supplierContactsAsOptions }}
            {{/if}}
            {{> afQuickField name="supplierReference" id="supRef"}}
            {{> afQuickField name="userId" type="hidden" value=currentUser}}
            {{> afQuickField name="status" options="allowed" value="Requested" type="hidden"}}
            {{> afQuickField name="orderDate" type="hidden" type="bootstrap-datetimepicker" value=currentDateTime }}
            {{> afQuickField name="paymentMethod" options="allowed" id="payMethod"}}
            {{> afQuickField name="notes" id="notes"}}
            {{> afQuickField name="createdBy" value=currentUser }}
            <p>Items can be added on the purchase order details page</p>
            <br />
            <button type="submit" class="btn btn-primary" id="create-purchase-order">Create</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>

<template name="newCompanyPurchaseOrderForm">
  <div class="modal fade" id="draggableModal">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h5> Add new purchase order</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrders" id="newPurchaseOrderForm" type="insert"}}
            {{> afQuickField name="description"}}
            {{> afQuickField name="supplierCompanyId" id="selectedSupplier" options=companiesAsOptions }}
            {{#if showSupplierContacts}}
              {{> afQuickField name="supplierContactId" id="selectedSupplierContact" options=supplierContactsAsOptions }}
            {{/if}}
            {{> afQuickField name="supplierReference" }}
            {{> afQuickField name="userId" type="hidden" value=currentUser}}
            {{> afQuickField name="status" options="allowed" value="Requested" type="hidden"}}
            {{> afQuickField name="orderDate" type="hidden" type="bootstrap-datetimepicker" value=currentDateTime }}
            {{> afQuickField name="paymentMethod" options="allowed"}}
            {{> afQuickField name="notes"}}
            {{> afQuickField name="createdBy" value=currentUser }}

            <p>Items can be added on the purchase order details page</p>
            <br />

            <button type="submit" class="btn btn-primary">Create</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>


<template name="newContactPurchaseOrderForm">
  <div class="modal fade" id="draggableModal">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h5> Add new purchase order</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrders" id="newPurchaseOrderForm" type="insert"}}
            {{> afQuickField name="description"}}
            {{> afQuickField name="supplierCompanyId" id="selectedSupplier" options=companiesAsOptions }}
            {{#if showSupplierContacts}}
              {{> afQuickField name="supplierContactId" id="selectedSupplierContact" options=supplierContactsAsOptions }}
            {{/if}}
            {{> afQuickField name="supplierReference" }}
            {{> afQuickField name="userId" type="hidden" value=currentUser}}
            {{> afQuickField name="status" options="allowed" value="Requested" type="hidden"}}
            {{> afQuickField name="orderDate" type="hidden" type="bootstrap-datetimepicker" value=currentDateTime }}
            {{> afQuickField name="paymentMethod" options="allowed"}}
            {{> afQuickField name="notes"}}
            {{> afQuickField name="createdBy" value=currentUser }}

            <p>Items can be added on the purchase order details page</p>
            <br />

            <button type="submit" class="btn btn-primary">Create</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>

<template name="updatePurchaseOrderFormModal">
  <div class="modal fade" id="draggableModal">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <h5> Edit purchase order</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrders" id="updatePurchaseOrderForm" type="update" doc=this}}

            {{> afQuickField name="description"}}
            {{> afQuickField name="supplierCompanyId" id="selectedSupplier" options=companiesAsOptions value=supplierCompanyId }}
            {{#if showSupplierContacts}}
              {{> afQuickField name="supplierContactId" id="selectedSupplierContact" options=supplierContactsAsOptions }}
            {{/if}}
            {{> afQuickField name="supplierReference" }}
            {{> afQuickField name="status" options="allowed" id="poStatus" firstOption=false}}
            {{> afQuickField name="paymentMethod" options="allowed"}}
            {{> afQuickField name="notes"}}
            <button type="submit" class="btn btn-success" id="update-purchase-order">Update</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>

<template name="addPurchaseOrderItemModal">
  <div class="modal" id="draggableModal">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <h5>Add new purchase order item</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrderItems" id="addPurchaseOrderItem" type="insert"}}
            {{> afQuickField name="purchaseOrderId" type="hidden" value=project._id}}
            {{> afQuickField name="description" id="description"}}
            {{> afQuickField name="productCode" id="code"}}
            {{> afQuickField name="status" options="allowed" id="status"}}
            {{> afQuickField name="value" id="itemValue" }}
            {{> afQuickField name="quantity" id="currQuant"}}
            {{> afQuickField name="totalPrice" readonly=true id="activePrice" }}
            {{> afQuickField name="projectId" options=projectsAsOptions id="project"}}
            {{> afQuickField name="createdBy" value=currentUser }}
            <button type="submit" class="btn btn-primary" id="add-item-to-po">Create</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>

<template name="editPurchaseOrderItemModal">
  <div class="modal" id="draggableModal">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <h5>Edit purchase order item</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrderItems" id="editPurchaseOrderItem" type="update" doc=this}}
            {{> afQuickField name="description" id="description"}}
            {{> afQuickField name="productCode" id="code"}}
            {{> afQuickField name="status" options="allowed" id="status"}}
            {{> afQuickField name="value" id="itemValue"}}
            {{> afQuickField name="quantity" id="currQuant"}}
            {{> afQuickField name="totalPrice" readonly=true id="activePrice"}}
            {{> afQuickField name="projectId" id="currProj" options=projectsAsOptions }}
            <button type="submit" class="btn btn-primary" id="update-po-item">Update</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>
