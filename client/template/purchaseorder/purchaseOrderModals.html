<template name="newPurchaseOrderForm">
  <div class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <h5>New Purchase Order</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrders" id="newPurchaseOrderForm" type="insert"}}
            {{> afQuickField name="description"}}

            {{> afQuickField name="supplierCompanyId" id="selectedSupplier" options=companiesAsOptions}}

            {{#if showContacts}}
              {{> afQuickField name="supplierContactId" id="companyContacts" options=contactsAsOptions }}
            {{/if}}

            {{> afQuickField name="projectId" options=projectsAsOptions }}

            {{> afQuickField name="supplierReference" }}

            {{> afQuickField name="userId"  type="hidden" value=currentUser}}

            {{> afQuickField name="status" options="allowed"}}
            {{> afQuickField name="orderDate" type="hidden" value=currentDateTime }}
            {{> afQuickField name="paymentMethod" options="allowed"}}

            {{> afQuickField name="createdBy" value=currentUser }}

            <h4><span class="label label-success center-block">Items can be added in the Purchase Order Details screen </span></h4><br />

            <button type="submit" class="btn btn-primary">Submit</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>

<template name="updatePurchaseOrderFormModal">
  <div class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <h5>Edit Purchase Order</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrders" id="updatePurchaseOrderForm" type="update" doc=this}}
            {{> afQuickField name="description"}}

            {{> afQuickField name="supplierCompanyId" id="selectedSupplier" options=companiesAsOptions}}

            {{#if showContacts}}
              {{> afQuickField name="supplierContactId" id="companyContacts" options=contactsAsOptions }}
            {{/if}}

            {{> afQuickField name="projectId" options=projectsAsOptions }}

            {{> afQuickField name="supplierReference" }}

            {{> afQuickField name="status" options="allowed"}}
            {{> afQuickField name="deliveryDate" }}
            {{> afQuickField name="paymentMethod" options="allowed"}}

            <button type="submit" class="btn btn-success">Update</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>

<template name="addPurchaseOrderItemModal">
  <div class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <h5>Add item</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrderItems" id="addPurchaseOrderItem" type="insert"}}
            {{> afQuickField name="purchaseOrderId" type="hidden" value=project._id}}
            {{> afQuickField name="description"}}
            {{> afQuickField name="productCode" }}
            {{> afQuickField name="currency" options="allowed"}}
            {{> afQuickField name="value" id="itemValue"}}
            {{> afQuickField name="quantity" id="currQuant"}}
            {{> afQuickField name="totalPrice" readonly=true id="activePrice" }}
            {{> afQuickField name="createdBy" value=currentUser }}
            <button type="submit" class="btn btn-success">Add</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>

<template name="editPurchaseOrderItemModal">
  <div class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <h5>Edit item</h5>
        </div>

        <div class="modal-body">
          {{#autoForm collection="PurchaseOrderItems" id="editPurchaseOrderItem" type="update" doc=this}}
            {{> afQuickField name="description"}}
            {{> afQuickField name="productCode" }}
            {{> afQuickField name="currency" options="allowed"}}
            {{> afQuickField name="value" id="itemValue"}}
            {{> afQuickField name="quantity" id="currQuant"}}
            {{> afQuickField name="totalPrice" readonly=true id="activePrice"}}
            <button type="submit" class="btn btn-success">Update</button>
          {{/autoForm}}
        </div>

      </div>
    </div>
  </div>
</template>
