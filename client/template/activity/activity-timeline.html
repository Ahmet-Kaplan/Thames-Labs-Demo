<!-- thanks to http://bootsnipp.com/snippets/featured/timeline-responsive -->

<template name="activityTimeline">
  {{#if activities.count}}
    <ul id="timeline" class="timeline">
      {{#each indexedArray activities}}
        <li class="{{timelineClass _index}}">
          <div class="timeline-badge"><i class="fa fa-{{timelineIcon type}}"></i></div>
          <div class="timeline-panel">
            <div class="timeline-heading">
              <h4 class="timeline-title">
                {{#if isPrimaryEntity}}
                  {{type}}
                  <div class="btn-group pull-right">
                    <a href="#" id="edit-activity" class="btn btn-info btn-xs"><i class="fa fa-fw fa-pencil"></i>Edit</a>
                    <a href="#" id="remove-activity" class="btn btn-danger btn-xs"><i class="fa fa-fw fa-times"></i>Delete</a>
                  </div>
                {{else}}
                  {{type}}
                  <div class="btn-group pull-right">
                    <a href="{{pathFor route=primaryEntityType id=primaryEntityId}}" data-toggle="tooltip" title="This activity is stored against a related item. Click here to view it." id="view-activity" class="btn btn-success btn-xs"><i class="fa fa-fw fa-{{entityIcon}}"></i> View {{friendlyEntity}}</a>
                  </div>
                {{/if}}
              </h4>
              <p>
                <small class="text-muted">
                  <span data-toggle="tooltip" title="{{activityTimestamp}}"><i class="fa fa-clock-o"></i> {{fromNow activityTimestamp}}</span>
                  {{#if isPrimaryEntity}}
                    {{#if contact}}
                      | <a href="{{pathFor route="contact" id=contact._id}}">{{contact.name}}</a>
                    {{/if}}
                  {{/if}}
                  {{#unless ownActivity createdBy}}
                    <span class="pull-right" data-toggle="tooltip" title="{{otherUser createdBy}} created this activity">{{otherUser createdBy}}</span>
                  {{/unless}}
                </small>
              </p>
            </div>
            <div class="timeline-body">
              {{{content}}}
            </div>

            {{#if isPrimaryEntity}}
              <div class="timeline-footer">
                <br />
                {{> tagInput tags=tags collection='activities' entityId=_id}}
              </div>
            {{/if}}
          </div>
        </li>
      {{/each}}
    </ul>
  {{else}}
    <h4 class="text-muted">No activity has been recorded ...</h4>
  {{/if}}
</template>
